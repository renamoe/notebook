## 线性基

[线性基学习笔记](https://oi.men.ci/linear-basis-notes/) - menci

## 拉格朗日插值

$$
F(x)=\sum_{i}\left(y_i\prod_{j\neq i}\frac{x-x_j}{x_i-x_j}\right)
$$

### 求系数

$\mathcal O(n^3)$ 模拟多项式乘法即可。

$\mathcal O(n^2)$ 需要模拟多项式除法。

```cpp
std::vector<int> lagrange(int n, std::vector<int> x, std::vector<int> y) {
	std::vector<int> l(n + 1), t(n + 1), res(n);
	l[0] = 1;
	for (int i = 0; i < n; ++i) {
		for (int j = 1; j <= n; ++j)
			t[j] = l[j - 1];
		t[0] = 0;
		for (int j = 0; j <= n; ++j)
			inc(t[j], times(l[j], P - x[i]));
		std::swap(l, t);
	}
	for (int i = 0; i < n; ++i) {
		int p = 1;
		for (int j = 0; j < n; ++j)
			if (j != i)
				mul(p, plus(x[i], P - x[j]));
		p = times(y[i], inverse(p));
		int inv = inverse(P - x[i]);
		int last = 0;
		for (int j = 0; j < n; ++j) {
			int now = times(plus(l[j], P - last), inv);
			inc(res[j], times(now, p));
			last = now;
		}
	}
	return res;
}
```

### 二元拉格朗日插值

若 $x_i,y_j$ 的点值为 $a_{i,j}$，求原多项式 $F(x,y)$。

设 
$$
f(i)=\prod_{j\neq i}\frac{x-x_j}{x_i-x_j},g(i)=\prod_{j\neq i}\frac{y-y_j}{y_i-y_j}
$$
那么原多项式为
$$
\sum_{i,j}f(i)g(j)a_{i,j}
$$

## GF

[生成函数学习笔记](https://www.cnblogs.com/UntitledCpp/p/GeneratingFunction_Study.html)

https://blog.csdn.net/a_forever_dream/article/details/106520376

### exp & ln

定义
$$
\exp(F(x))=\sum_{k=0}\frac{F(x)^{k}}{k!}
$$
，要求 $[x^0]F(x)=0$。

定义
$$
\ln(F(x))=\sum_{k=1}\frac{(-1)^{k+1}(F(x)-1)^{k}}{k}
$$
，要求 $[x^0]F(x)=1$。

### EGF

$$
F(x)=\sum_n f_n\frac{x^n}{n!}
$$

$$
F(x)G(x)=\sum_{n}\bigg(\sum_{i=0}^n\binom{n}{i}f_ig_{n-i}\bigg)\frac{x^n}{n!}
$$



## polya 定理

设置换 $f$ 下不变的方案数为 $C(f)$，本质不同的方案为
$$
\frac{1}{|G|}\sum_{f\in G}C(f)
$$
在染色问题中，若颜色数为 $m$，$L(f)$ 为置换 $f$ 形成的环的个数，本质不同的方案数为
$$
\frac{1}{|G|}\sum_{f\in G}m^{L(f)}
$$

## 1/(1-x)^k

求 $\left(\dfrac{1}{1-x}\right)^c$ 的第 $n$ 项系数：
$$
\left(\frac{1}{1-x}\right)^c=\left(1+x+x^2+x^3+\dots\right)^c
$$
这个生成函数的组合意义便是把一个数拆成 $c$ 个非负整数和的方案数。利用插板法可以得到
$$
[x^n]\left(\frac{1}{1-x}\right)^c=\binom{n+c-1}{c-1}=\binom{n+c-1}{n}
$$

## 二项式相关

$$
\sum_{i=0}^n{m+i\choose i}={m+n+1\choose n}
$$

## Lucas 定理证明

二项式展开 $(1+x)^n$，

$$
(1+x)^n=\sum_{i=0}^n{n\choose i}x^i
$$

将指数 $n$ 表示为 $tp+r$，因为我们知道

$$
{p\choose i}\bmod p=\frac{p!}{i!(p-i)!}\bmod p=0\quad(0<i<p)
$$

特别地，$\displaystyle{p\choose 0}={p\choose p}=1$。

$$
\begin{aligned}
(1+x)^{tp+r}&\equiv\left((1+x)^p\right)^t\cdot (1+x)^r\\
&\equiv\left(1+x^p\right)^t\cdot (1+x)^r\\
&\equiv\left(\sum_{i=0}^t{t\choose i}x^{ip}\right)\left(\sum_{j=0}^r{r\choose j}x^j\right)
\end{aligned}\pmod p
$$

可以发现 $x^m$ 与 $x^{ip+j}$ 唯一对应，那么

$$
{n\choose m}\equiv{n\bmod k\choose m\bmod k}\times{\lfloor n/k\rfloor\choose \lfloor m/k\rfloor}\pmod p
$$
