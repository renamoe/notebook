## 10.19

### T2

二分然后判负环和 $\mathrm{dis}(n)\ge 0$。

注意先在反图上 dfs 来去掉不可能到达 $n$ 的点，避免无用负环的影响。

### T3

每个点 $i$ 向 $i+1$ 连边，那么区间合法的条件为 $r-l=\text{边数}$。

从左往右不断加边，查找左边 $r-l=s_l$ 的合法 $l$ 数量。线段树维护 $s_l-(r-l)$，这个值一定是 $\le 0$ 的，维护区间最大值及其个数即可。

分块撑死 $70$ 分，好气。

### T4

每个点选取一个儿子的子集满足两两互质，然后做最大独立集的 DP。

可以发现真正有用的转移是找到约数 $d$ 满足 $\gcd(d,i/d)=1$，就是个多叉转二叉的过程。

预处理约数，然后用一些 $O(1)$ 的手段判断互质可以做到 $\mathcal O(n\log n)$。

判互质可以用 $\mathcal O(n)-\mathcal O(1)$ 的 $\gcd$，也可以 $\texttt{std::bitset<>}$ 状压 $\sqrt n$ 以内的质数（172 个）。

然后被卡常卡成 $55$ 分。

其实可以预处理质因子集合，每次枚举子集，两个子集代表的约数就一定互质，再加上枚举约数的转移，复杂度 $\mathcal O(n\log n+\sum_{i=1}^n2^{\omega(i)})$。后面的 $\sum_{i=1}^n2^{\omega(i)}$ 大约是 $10^7$ 级别，由于省去了判断互质的常数所以能过。

讲真的这个出题人不太行。
