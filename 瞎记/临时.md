## 11.13

XJ 公开赛。

### T1

不考虑最小化次数，能刷尽量刷，求出每个位置开头刷的高度，就可以求出每个位置最终被刷的高度，两遍单调队列。

每个连续段贪心即可最小化次数。

### T2

第 $i$ 个数能被异或上的数，是第 $1\dots i-1$ 个数构成的线性基所能表示的所有数。

### T3

记状态 $(u,d,k)$ 表示到 $u$ 点步数为 $d$ 乘积为 $k$。每个点有用的状态数不多，至多 $500$，我也不知道为啥。题解说是类似整除分块，是根号级别的。

那么直接做 SPFA，每次只保留乘积超过当前最大值的状态，即可保证无冗余状态。

## T4

首先因为操作是可逆的，将 $a,b$ 序列都排序。

$l=r-1$ 时操作可以交换相邻两数；

$\lfloor\frac{r-l+1}{2}\rfloor$ 次操作可以 reverse 一个有序区间；

两个相邻的有序序列 $a_{1\dots n},b_{1\dots m}$ 满足 $a_i>b_j$，可以通过三次 reverse 排序。

发现这个操作次数的规模大约是让我们归并排序。

归并两段相邻有序序列 $[l,\mathrm{mid}],[\mathrm{mid}+1,r]$，可以找到 $x,y$ 使得 $l\dots x$ 和 $\mathrm{mid}+1\dots y$ 是最小的 $\frac{r-l+1}{2}$ 个数，那么排序 $x+1\dots y$ 可以让最小的 $\frac{r-l+1}{2}$ 个数都移动到左侧。然后递归处理。

操作次数是 $\mathcal O(n\log^2n)$ 的。

题解说 $n=4000$ 随机数据期望下可以卡进 $300000$ 的限制。

两个相邻的有序序列排序的操作次数是 $\mathrm{len}-x+y$ 的，期望下是 $1$ 倍 $\mathrm{len}$ 的，最坏 $2$ 倍 $\mathrm{len}$。然而将序列排序为正序和倒序是对称的，两者在此处的操作次数之和是 $2\times \mathrm{len}$，都做一遍取较小的可以稳定通过。


