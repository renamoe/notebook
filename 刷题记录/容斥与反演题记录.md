
## P4515 \[COCI2009-2010#6\] XOR

[link](https://www.luogu.com.cn/problem/P4515)

暴力容斥。我们知道答案一定可以写成 $\sum_{S}f(S)g(|S|)$ 的形式。

枚举一个三角形的集合 $S$，交的面积为 $f(S)$。计算 $f(S)$ 只要找到限制最紧的横线、竖线和斜线，也就是交三角形的半径 $\displaystyle R=\min_{i\in S}(x_i+y_i+r_i)-\max_{i\in S}x_i-\max_{i\in S}y_i$。

求容斥系数 $g(|S|)$。要让覆盖偶数次的三角形不产生贡献，设一个区域恰好被覆盖 $k$ 次，

$$
\sum_{i=0}^k{k\choose i}g(i)=[2\nmid k]
$$

二项式反演得到

$$
\begin{aligned}
g(k)&=\sum_{i=0}^k{k\choose i}(-1)^{k-i}[2\nmid i]\\
&=(-1)^{k+1}\sum_{i=0}^k{k\choose i}[2\nmid i]\\
&=(-1)^{k+1}\frac{(1+1)^k}{2}\\
&=(-2)^{k-1}
\end{aligned}
$$

复杂度 $\mathcal O(2^nn)$。

[code(0)](https://gitee.com/renamoe/pastebin/blob/master/LuoguP4515.cpp)

## HDU#2204. Eddy's爱好

[link](https://vjudge.net/problem/HDU-2204)

在指数上枚举质数的倍数进行容斥。

$2^{2\times 3\times 5\times 7}>10^{18}$，所以枚举的质数集合大小至多为 $3$

$2^{60}>10^{18}$ 最大的质数大小至多为 $59$，共 $17$ 个质数。

容斥系数显然是 $(-1)^{|S|+1}$。

[code(0)](https://vjudge.net/solution/33104621)

## P2167 \[SDOI2009\]Bill的挑战 

[link](https://www.luogu.com.cn/problem/P2167)

满足集合 $S$ 限制的字符串数 $f(S)$，满足恰好集合 $T$ 限制的字符串数 $g(S)=\sum_{S\subseteq T\subseteq U}(-1)^{|T|-|S|}f(T)$。

那么容斥系数为 $(-1)^{|S|-k}{|S|\choose k}$。

[code(3)](https://gitee.com/renamoe/pastebin/blob/master/LuoguP2167.cpp)

## 51nod#1667 概率好题

[link](https://vjudge.net/problem/51Nod-1667)

以求 $\displaystyle\sum_{i=1}^{k_1}X_i<\sum_{i=1}^{k_2}Y_i$ 方案数为例。

先去掉下界的限制。设 $x_i\in [0,R_{1,i}-L_{1,i}]$, $y_i\in [0,R_{2,i}-L_{2,i}]$，原式改写为

$$
\begin{aligned}
\sum_{i=0}^{k_1}L_{1,i}+x_i&<\sum_{i=0}^{k_2}R_{2,i}-y_i\\
\sum_{i=0}^{k_1}x_i+\sum_{i=0}^{k_2}y_i+k&=\sum_{i=0}^{k_2}R_{2,i}-\sum_{i=0}^{k_1}L_{1,i}-1
\end{aligned}
$$

那么可以转化为：$n$ 个数总和为 $m$，每个数有上界 $a_i$ 的限制，求合法序列方案数。$\mathcal O(2^n)$ 容斥。

过程中组合数 $\displaystyle{x\choose y}$ 的 $x$ 很大，但是 $y$ 很小，拆为 $\dfrac{x^{y\downarrow}}{y!}$ 即可。

[code(0)](https://gitee.com/renamoe/pastebin/blob/master/51nod1667.cpp)
